/* Compact Input Box */
@container style(--\\--compact-input-box: true) {
	:is(form, form > div) {
		& > div[class*="channelBottomBarArea"] {
			--custom-channel-textarea-text-area-height: 44px;
			div[class*="attachButton_"] > div[class*="icon_"] {
				padding: 10px 16px;
			}
		}

		& > [class*="wrapper__"] {
			padding: 10px;
			& > div {
				margin-left: 0;
				margin-right: 0;
			}
		}

		div[class*="textArea_"] + div[class*="buttons_"] {
			gap: 0;
		}
	}

	div[class*="jumpToPresentBar_"], div[class*="jumpToPresentBar_"]:active {
		margin-bottom: 1px;
		min-height: 0;
		button {
			min-height: 0;
			height: unset;
		}
	}
}

/* Compact User Area */
@container style(--\\--compact-user-area: true) {
	section[aria-label="User area"], div[class*="sidebar_"] > section[aria-label] {
		left: 0 !important;
		bottom: 0 !important;
		border-radius: 0 !important;
		border: none !important;
		width: 100% !important;
		background-color: color-mix(in oklab, var(--background-tertiary, var(--background-base-lowest)), #121214 11%) !important;

		& > [class*="wrapper_"] > [class*="container_"] {
			--space-xs: 6px;
		}
	}

	nav[class*="privateChannels__"] > div[class*="scroller__"], nav[aria-label="Servers sidebar"], nav[class*="guilds_"] {
		margin-bottom: calc(var(--custom-app-panels-height, 0)) !important;
	}

	[class*="sidebarList_"] #channels {
		margin-bottom: 0;
	}

	[class*="activityPanel_"] {
		background-color: transparent;
		padding-top: 4px;
		padding-bottom: 4px;
	}

	[class*="rtcConnectionStatusWrapper__"] {
		[class*="labelWrapper__"] [class*="rtcConnectionStatusLabel__"] > div > div {
			font-size: 100%;
		}

		[class*="rtcConnectionStatus__"] + a > div > div {
			font-size: 100%;
		}
	}
}

@container style(--\\--compact-channel-categories: true) {
	ul[aria-label="Channels"] {
		li[class*="containerDefault_"]:not([class*="containerDefault__"]) a[class*="link__"] {
			--radius-sm: 5px;
		}

		li[class*="containerDefault__"] h3:is([class*="name__"], [class*="header__"]) > div {
			font-size: 95%;
			font-weight: 600;
			text-transform: uppercase;
		}
	}
}

/* Compact Guild Bar */
.appMount {
  container-type: style;
  container-name: compact-guilds-bar;
}

/* Default styling (non-compact) */
ul[data-list-id="guildsnav"] > div.itemsContainer_ef3116 > div.stack_dbd263 {
  margin-top: var(--guild-stack-margin) !important;
}

/* Scoped compact styling when enabled */
@container style(--\\--compact-guilds-bar: true) {
  :root {
    --guild-stack-margin: 0;
  }

  nav[class*="guilds"]::-webkit-scrollbar {
    display: none !important;
  }

  nav[class*="guilds"] {
    --paddingY: 15px;
    position: absolute !important;
    z-index: 100 !important;
    top: var(--guild-server-bar, 60%) !important;
    max-height: 70vh !important;
    overflow-y: auto !important;
    transform: translate(-80%, -50%) !important;
    transition: all 0.3s ease !important;
    border-radius: 20px !important;
    border: 2.2px solid var(--mc) !important;
    box-shadow: rgba(0, 0, 0, 0.2) 5px 5px 5px 5px !important;
    height: 10vh !important;
    background-color: #121214 !important;
  }

  nav[class*="guilds"] .wrapper__9916c,
  nav[class*="guilds"] .listItem__48528:not(.folderPreview__48112):not(.expandedFolderIconWrapper__48112) {
    transform: scale(0) !important;
  }

  nav[class*="guilds"]:hover {
    transform: translate(0%, -50%) !important;
    height: auto !important;
  }

  nav[class*="guilds"]:hover .wrapper__9916c,
  nav[class*="guilds"]:hover .listItem__48528:not(.folderPreview__48112):not(.expandedFolderIconWrapper__48112) {
    transform: scale(1) !important;
  }

  /* Background fixes */
  .theme-dark .container-2cd8Mz,
  .membersWrap_c8ffbb .container_cbd271 {
    background-color: transparent !important;
  }

  /* Padding inside scroll container */
  nav[class*="guilds"] div[class*="scroller_"],
  .membersWrap_c8ffbb .container_cbd271 {
    padding-top: var(--paddingY) !important;
    padding-bottom: var(--paddingY) !important;
    box-sizing: border-box !important;
  }

  ul[data-list-id="guildsnav"] > div.itemsContainer_ef3116 > div.stack_dbd263 {
    padding-top: 0 !important;
  }
}

/* Compact state â€” borders hidden when no-border is enabled */
.appMount {
  container-type: style;
  container-name: no-border;
}

@container style(--\\--no-border: true) {
  .visual-refresh {
    [class^="container_"] {
      border: 0px !important;
    }

    [class^="chat_"][data-has-border="true"] {
      border: 0px !important;
    }

    [class^="sidebarList_"],
    [class^="sidebarResizeHandle_"] {
      border: 0px !important;
    }

    [class^="sectionDivider_"] {
      display: none !important;
    }

    &.theme-midnight {
      [class^="container_"],
      [class^="content_"],
      [class^="subtitleContainer_"] {
        border: 0px !important;
      }
    }
  }
}

/* Semi-Compact-IRC */
@container style(--\\--irc-compact-chats: true) {
  [class*="cozy_"] {
    --chat-avatar-size: 1.2em;
    --custom-message-avatar-size: 1em;
    --custom-message-margin-left-content-cozy: var(--custom-message-margin-horizontal);

    [class^="header_"] {
      margin-left: calc(var(--custom-message-avatar-size) + var(--space-xs));
    }
    [class^="repliedMessage_"] {
      margin-left: calc(var(--custom-message-avatar-size) + var(--custom-message-margin-horizontal));
    }
    &[class*="hasThread_"]:after {
      left: calc(var(--custom-message-margin-horizontal) - var(--space-xs) - 1px);
      width: var(--space-xs);
      
      border-top: 2px solid var(--spine-default);
      border-top-left-radius: 8px;
      top: calc(
        var(--custom-message-spacing-vertical-container-cozy) 
        + var(--custom-message-avatar-size)/2
      ) !important;
    }
    &[class*="hasThread_"][class*="hasReply_"]:after {
      top: calc(
        var(--custom-message-spacing-vertical-container-cozy) 
        + var(--custom-message-avatar-size)/2 
        + var(--custom-message-reply-message-preview-line-height) 
        + 4px
      ) !important;
    }
    [class*="timestamp_"][class*="alt_"] {
      width: 100%;
    }
  }
}